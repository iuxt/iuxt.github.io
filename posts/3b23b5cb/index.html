<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>二进制安装MySQL5.7 | 杂烩饭</title><meta name="author" content="张理坤"><meta name="copyright" content="张理坤"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="如有特殊需求需要编译安装 MySQL 请看 编译安装MySQL5.7 准备工作卸载系统中的 MySQL 或 mariadb123rpm -qa | grep mysqlrpm -qa | grep mariadbyum remove xxx  下载二进制安装包MySQL官网 选择操作系统为 Linux-Generic 选择下载文件名为：mysql-5.7.39-linux-glibc2.12-x8">
<meta property="og:type" content="article">
<meta property="og:title" content="二进制安装MySQL5.7">
<meta property="og:url" content="https://zahui.fan/posts/3b23b5cb/">
<meta property="og:site_name" content="杂烩饭">
<meta property="og:description" content="如有特殊需求需要编译安装 MySQL 请看 编译安装MySQL5.7 准备工作卸载系统中的 MySQL 或 mariadb123rpm -qa | grep mysqlrpm -qa | grep mariadbyum remove xxx  下载二进制安装包MySQL官网 选择操作系统为 Linux-Generic 选择下载文件名为：mysql-5.7.39-linux-glibc2.12-x8">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://static.zahui.fan/public/MySQL.svg">
<meta property="article:published_time" content="2022-08-14T03:41:08.000Z">
<meta property="article:modified_time" content="2024-10-31T03:20:09.000Z">
<meta property="article:author" content="张理坤">
<meta property="article:tag" content="配置记录">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://static.zahui.fan/public/MySQL.svg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "二进制安装MySQL5.7",
  "url": "https://zahui.fan/posts/3b23b5cb/",
  "image": "https://static.zahui.fan/public/MySQL.svg",
  "datePublished": "2022-08-14T03:41:08.000Z",
  "dateModified": "2024-10-31T03:20:09.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "张理坤",
      "url": "https://zahui.fan/"
    }
  ]
}</script><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://zahui.fan/posts/3b23b5cb/"><link rel="preconnect"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/site.webmanifest"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?50b516d50102c8c9ac5f80529b81ca17";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-YN0WWZGVYN"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'G-YN0WWZGVYN')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'G-YN0WWZGVYN', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '二进制安装MySQL5.7',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://static.zahui.fan/libs/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" /><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="杂烩饭" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://static.zahui.fan/public/dog.svg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">351</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">218</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://bbk-games.zahui.fan/"><i class="fa-fw fas fa-gamepad"></i><span> 小游戏</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://aria2.babudiu.com/"><i class="fa-fw fas fa-download"></i><span> Aria2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://file.babudiu.com/"><i class="fa-fw fa-solid fa-file"></i><span> 网盘</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-paperclip"></i><span> 林克</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-brands fa-apple fa-bounce"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(https://static.zahui.fan/public/MySQL.svg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="https://static.zahui.fan/public/boob.png" alt="Logo"><span class="site-name">杂烩饭</span></a><a class="nav-page-title" href="/"><span class="site-name">二进制安装MySQL5.7</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://bbk-games.zahui.fan/"><i class="fa-fw fas fa-gamepad"></i><span> 小游戏</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://aria2.babudiu.com/"><i class="fa-fw fas fa-download"></i><span> Aria2</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://file.babudiu.com/"><i class="fa-fw fa-solid fa-file"></i><span> 网盘</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-paperclip"></i><span> 林克</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-brands fa-apple fa-bounce"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">二进制安装MySQL5.7</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-14T03:41:08.000Z" title="发表于 2022-08-14 11:41:08">2022-08-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-31T03:20:09.000Z" title="更新于 2024-10-31 11:20:09">2024-10-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;此文章距离发布已经&quot;,&quot;messageNext&quot;:&quot;天了，内容可能已经过时，请自行判断是否可用或联系博主更新。&quot;,&quot;postUpdate&quot;:&quot;2024-10-31 11:20:09&quot;}" hidden></div><p>如有特殊需求需要编译安装 MySQL 请看 <a href="/posts/b670229a">编译安装MySQL5.7</a></p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="卸载系统中的-MySQL-或-mariadb"><a href="#卸载系统中的-MySQL-或-mariadb" class="headerlink" title="卸载系统中的 MySQL 或 mariadb"></a>卸载系统中的 MySQL 或 mariadb</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep mysql</span><br><span class="line">rpm -qa | grep mariadb</span><br><span class="line">yum remove xxx</span><br></pre></td></tr></table></figure>

<h3 id="下载二进制安装包"><a href="#下载二进制安装包" class="headerlink" title="下载二进制安装包"></a>下载二进制安装包</h3><p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://dev.mysql.com/downloads/mysql/5.7.html#downloads">MySQL官网</a></p>
<p>选择操作系统为 <code>Linux-Generic</code></p>
<p>选择下载文件名为：<code>mysql-5.7.39-linux-glibc2.12-x86_64.tar.gz</code></p>
<p>当然也可以用 wget 直接下载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.39-linux-glibc2.12-x86_64.tar.gz</span><br></pre></td></tr></table></figure>

<h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -M -s /sbin/nologin -r mysql</span><br></pre></td></tr></table></figure>

<h3 id="安装依赖包"><a href="#安装依赖包" class="headerlink" title="安装依赖包"></a>安装依赖包</h3><p>为了避免执行 mysql 命令报错 <code>ibncurses.so.5</code> 或者 <code>libnuma.so.1</code> 找不到</p>
<div class="tabs"><div class="nav-tabs"><button type="button" class="tab active">CentOS</button><button type="button" class="tab">Ubuntu</button></div><div class="tab-contents"><div class="tab-item-content active"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y ncurses-devel numactl-libs</span><br></pre></td></tr></table></figure>

<p>注意： CentOS 9 或 RHEL 9 如果找不到这个库，可以参考：<a href="/posts/lv23gkql/">解决MySQL 5.7在Redhat 9中启动报错：libncurses.so.5和libtinfo.so.5缺失问题</a></p></div><div class="tab-item-content"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install -y libncurses5 libnuma1 libaio1</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>

<h3 id="设置安装路径"><a href="#设置安装路径" class="headerlink" title="设置安装路径"></a>设置安装路径</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> BASE_DIR=<span class="string">&quot;/usr/local/mysql&quot;</span></span><br><span class="line"><span class="built_in">export</span> DATA_DIR=<span class="string">&quot;/data/mysql&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="解压安装包"><a href="#解压安装包" class="headerlink" title="解压安装包"></a>解压安装包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -xf mysql-5.7.39-linux-glibc2.12-x86_64.tar.gz -C /usr/local/</span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$&#123;BASE_DIR&#125;</span>-5.7.39-linux-glibc2.12-x86_64/ <span class="variable">$&#123;BASE_DIR&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h2><h3 id="创建数据保存目录"><a href="#创建数据保存目录" class="headerlink" title="创建数据保存目录"></a>创建数据保存目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$&#123;DATA_DIR&#125;</span>/&#123;binlog,data,logs,redolog,relaylog,tmp,undolog&#125;</span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$&#123;BASE_DIR&#125;</span>/etc</span><br><span class="line"><span class="built_in">chown</span> -R mysql.mysql <span class="variable">$&#123;DATA_DIR&#125;</span></span><br><span class="line"><span class="built_in">touch</span> <span class="variable">$&#123;DATA_DIR&#125;</span>/logs/error_mysqld.log</span><br><span class="line"><span class="built_in">chown</span> -R mysql.mysql <span class="variable">$&#123;DATA_DIR&#125;</span>/logs/error_mysqld.log</span><br><span class="line"><span class="built_in">chown</span> -R mysql.mysql <span class="variable">$&#123;BASE_DIR&#125;</span></span><br><span class="line"><span class="built_in">chown</span> -R mysql.mysql <span class="variable">$&#123;BASE_DIR&#125;</span>-5.7.39-linux-glibc2.12-x86_64/</span><br></pre></td></tr></table></figure>

<h3 id="initialize"><a href="#initialize" class="headerlink" title="initialize"></a>initialize</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;BASE_DIR&#125;</span>/bin/mysqld --initialize --user=mysql --basedir=<span class="variable">$&#123;BASE_DIR&#125;</span> --datadir=<span class="variable">$&#123;DATA_DIR&#125;</span>/data</span><br><span class="line"><span class="comment"># 控制台会输出一个临时密码，需要记录一下</span></span><br></pre></td></tr></table></figure>

<h2 id="配置文件与服务"><a href="#配置文件与服务" class="headerlink" title="配置文件与服务"></a>配置文件与服务</h2><h3 id="创建最小化配置文件"><a href="#创建最小化配置文件" class="headerlink" title="创建最小化配置文件"></a>创建最小化配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; <span class="variable">$&#123;BASE_DIR&#125;</span>/etc/my.cnf &lt;&lt;-<span class="string">EOF</span></span><br><span class="line"><span class="string">## MySQL 5.7 Configuration File</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## General</span></span><br><span class="line"><span class="string">user                                   = mysql</span></span><br><span class="line"><span class="string">bind_address                           = 0.0.0.0</span></span><br><span class="line"><span class="string">port                                   = 3306</span></span><br><span class="line"><span class="string">basedir                                = $&#123;BASE_DIR&#125;/</span></span><br><span class="line"><span class="string">datadir                                = $&#123;DATA_DIR&#125;/data</span></span><br><span class="line"><span class="string">tmpdir                                 = $&#123;DATA_DIR&#125;/tmp</span></span><br><span class="line"><span class="string">socket                                 = $&#123;DATA_DIR&#125;/logs/mysql.sock</span></span><br><span class="line"><span class="string">pid-file                               = $&#123;DATA_DIR&#125;/logs/mysqld.pid</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">character_set_server                   = utf8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">skip-symbolic-links</span></span><br><span class="line"><span class="string">skip_name_resolve                      = ON</span></span><br><span class="line"><span class="string">skip_external_locking                  = ON</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">performance_schema                     = ON      # default ON</span></span><br><span class="line"><span class="string">performance-schema-instrument          = &#x27;memory/%=ON&#x27;</span></span><br><span class="line"><span class="string">#lower_case_table_names                 = 0      # default 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### Storage Engines</span></span><br><span class="line"><span class="string">default_storage_engine                 = InnoDB</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## InnoDB</span></span><br><span class="line"><span class="string">innodb_log_group_home_dir              = $&#123;DATA_DIR&#125;/redolog/</span></span><br><span class="line"><span class="string">innodb_log_file_size                   = 256M</span></span><br><span class="line"><span class="string">innodb_log_files_in_group              = 2</span></span><br><span class="line"><span class="string">innodb_log_buffer_size                 = 16M</span></span><br><span class="line"><span class="string">innodb_rollback_segments               = 128     # defautl 128</span></span><br><span class="line"><span class="string">innodb_undo_directory                  = $&#123;DATA_DIR&#125;/undolog/</span></span><br><span class="line"><span class="string">innodb_open_files                      = 4000</span></span><br><span class="line"><span class="string">innodb_thread_concurrency              = 32</span></span><br><span class="line"><span class="string">innodb_flush_log_at_trx_commit         = 1</span></span><br><span class="line"><span class="string">innodb_flush_log_at_timeout            = 1       # defautl 1, when innodb_flush_log_at_trx_commit = 0 or 2</span></span><br><span class="line"><span class="string">innodb_purge_threads                   = 4</span></span><br><span class="line"><span class="string">innodb_print_all_deadlocks             = ON</span></span><br><span class="line"><span class="string">innodb_max_dirty_pages_pct             = 70</span></span><br><span class="line"><span class="string">innodb_lock_wait_timeout               = 50</span></span><br><span class="line"><span class="string">innodb_flush_method                    = O_DIRECT</span></span><br><span class="line"><span class="string">innodb_old_blocks_time                 = 1000    # since 5.6.6 default 1000</span></span><br><span class="line"><span class="string">innodb_io_capacity                     = 600     # default 200</span></span><br><span class="line"><span class="string">innodb_io_capacity_max                 = 2000    # default 2000</span></span><br><span class="line"><span class="string">innodb_lru_scan_depth                  = 1024    # default 1024</span></span><br><span class="line"><span class="string">innodb_read_io_threads                 = 8</span></span><br><span class="line"><span class="string">innodb_write_io_threads                = 8</span></span><br><span class="line"><span class="string">innodb_buffer_pool_load_at_startup     = ON</span></span><br><span class="line"><span class="string">innodb_buffer_pool_dump_at_shutdown    = ON</span></span><br><span class="line"><span class="string">innodb_buffer_pool_filename            = ib_buffer_pool  # default ib_buffer_pool</span></span><br><span class="line"><span class="string">innodb_sort_buffer_size                = 64M     # default 1M , 64K - 64M , for change index</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">innodb_buffer_pool_dump_pct            = 40</span></span><br><span class="line"><span class="string">innodb_page_cleaners                   = 16</span></span><br><span class="line"><span class="string">innodb_undo_log_truncate               = ON</span></span><br><span class="line"><span class="string">innodb_max_undo_log_size               = 2G</span></span><br><span class="line"><span class="string">innodb_purge_rseg_truncate_frequency   = 128</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## Gtid</span></span><br><span class="line"><span class="string">#gtid_mode                              = ON</span></span><br><span class="line"><span class="string">#enforce_gtid_consistency               = ON</span></span><br><span class="line"><span class="string">#binlog_gtid_simple_recovery            = 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## Replication</span></span><br><span class="line"><span class="string">server_id                              = 101</span></span><br><span class="line"><span class="string">log_bin                                = $&#123;DATA_DIR&#125;/binlog/mysql_bin</span></span><br><span class="line"><span class="string">expire_logs_days                       = 7</span></span><br><span class="line"><span class="string">binlog_format                          = ROW</span></span><br><span class="line"><span class="string">binlog_row_image                       = noblob  # default full</span></span><br><span class="line"><span class="string">#innodb_autoinc_lock_mode               = 2      # default 1</span></span><br><span class="line"><span class="string">binlog_rows_query_log_events           = 1</span></span><br><span class="line"><span class="string">max_binlog_size                        = 500M</span></span><br><span class="line"><span class="string">binlog_cache_size                      = 1M</span></span><br><span class="line"><span class="string">sync_binlog                            = 1</span></span><br><span class="line"><span class="string">master_info_repository                 = TABLE</span></span><br><span class="line"><span class="string">relay_log_info_repository              = TABLE</span></span><br><span class="line"><span class="string">skip-slave-start                       = 1</span></span><br><span class="line"><span class="string">relay_log                              = $&#123;DATA_DIR&#125;/relaylog/relay_log</span></span><br><span class="line"><span class="string">max_relay_log_size                     = 500M   # default 0, use max_binlog_size</span></span><br><span class="line"><span class="string">log_slave_updates                      = ON     # default OFF</span></span><br><span class="line"><span class="string">slave_transaction_retries              = 128</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## MTS</span></span><br><span class="line"><span class="string">relay_log_recovery                     = 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## Logging</span></span><br><span class="line"><span class="string">log_output                             = FILE</span></span><br><span class="line"><span class="string">slow_query_log                         = ON</span></span><br><span class="line"><span class="string">slow_query_log_file                    = $&#123;DATA_DIR&#125;/logs/slow_mysqld.log</span></span><br><span class="line"><span class="string">log_queries_not_using_indexes          = OFF     # default OFF</span></span><br><span class="line"><span class="string">log_throttle_queries_not_using_indexes = 10      # default 0</span></span><br><span class="line"><span class="string">min_examined_row_limit                 = 0       # default 0</span></span><br><span class="line"><span class="string">log_slow_admin_statements              = ON</span></span><br><span class="line"><span class="string">log_slow_slave_statements              = ON</span></span><br><span class="line"><span class="string">long_query_time                        = 1</span></span><br><span class="line"><span class="string">#log-short-format                       = 0</span></span><br><span class="line"><span class="string">log_error                              = $&#123;DATA_DIR&#125;/logs/error_mysqld.log</span></span><br><span class="line"><span class="string">general_log                            = OFF</span></span><br><span class="line"><span class="string">general_log_file                       = $&#123;DATA_DIR&#125;/logs/general_mysqld.log</span></span><br><span class="line"><span class="string">log_timestamps                         = system</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## Index</span></span><br><span class="line"><span class="string">ft_min_word_len                        = 4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqld_safe]</span></span><br><span class="line"><span class="string">open_files_limit                       = 65535</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysql]</span></span><br><span class="line"><span class="string">no_auto_rehash</span></span><br><span class="line"><span class="string">prompt                                 = &quot;MySQL [\\d] &gt; &quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqldump]</span></span><br><span class="line"><span class="string">quick</span></span><br><span class="line"><span class="string">max_allowed_packet                     = 256M</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[mysqlhotcopy]</span></span><br><span class="line"><span class="string">interactive_timeout</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[client]</span></span><br><span class="line"><span class="string">socket                                 = $&#123;DATA_DIR&#125;/logs/mysql.sock</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<p>做软链接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/my.cnf&#123;,.bak&#125;</span><br><span class="line"><span class="built_in">ln</span> -s <span class="variable">$&#123;BASE_DIR&#125;</span>/etc/my.cnf /etc/my.cnf</span><br></pre></td></tr></table></figure>

<h3 id="生成-systemd-配置"><a href="#生成-systemd-配置" class="headerlink" title="生成 systemd 配置"></a>生成 systemd 配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /usr/lib/systemd/system/mysql.service &lt;&lt;-<span class="string">EOF</span></span><br><span class="line"><span class="string">[Unit]</span></span><br><span class="line"><span class="string">Description=MySQL Server</span></span><br><span class="line"><span class="string">Documentation=man:mysqld(8)</span></span><br><span class="line"><span class="string">Documentation=https://dev.mysql.com/doc/refman/en/using-systemd.html</span></span><br><span class="line"><span class="string">After=network.target</span></span><br><span class="line"><span class="string">After=syslog.target</span></span><br><span class="line"><span class="string">[Install]</span></span><br><span class="line"><span class="string">WantedBy=multi-user.target</span></span><br><span class="line"><span class="string">[Service]</span></span><br><span class="line"><span class="string">User=mysql</span></span><br><span class="line"><span class="string">Group=mysql</span></span><br><span class="line"><span class="string">ExecStart=$&#123;BASE_DIR&#125;/bin/mysqld --defaults-file=/etc/my.cnf</span></span><br><span class="line"><span class="string">LimitNOFILE = 5000</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure>

<h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> --now mysql</span><br></pre></td></tr></table></figure>

<h2 id="优化工作"><a href="#优化工作" class="headerlink" title="优化工作"></a>优化工作</h2><h3 id="添加环境变量"><a href="#添加环境变量" class="headerlink" title="添加环境变量"></a>添加环境变量</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="subst">$( grep <span class="string">&quot;<span class="variable">$&#123;BASE_DIR&#125;</span>/bin&quot;</span> /etc/profile | wc -l )</span>&quot;</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;export PATH=\$PATH:<span class="variable">$&#123;BASE_DIR&#125;</span>/bin&quot;</span> &gt;&gt; /etc/profile</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;PATH变量已添加&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>

<h3 id="修改-root-密码"><a href="#修改-root-密码" class="headerlink" title="修改 root 密码"></a>修改 root 密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一次登录需要使用root@localhost登录，密码为上面生成的临时密码</span></span><br><span class="line">mysql -uroot -hlocalhost -p</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;Vb6CAEJqqtcmKndiAkEl&#x27;</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">&#x27;Vb6CAEJqqtcmKndiAkEl&#x27;</span>;</span><br><span class="line"><span class="keyword">Grant</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">to</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> <span class="keyword">with</span> <span class="keyword">grant</span> option;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://zahui.fan">张理坤</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://zahui.fan/posts/3b23b5cb/">https://zahui.fan/posts/3b23b5cb/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://zahui.fan" target="_blank">杂烩饭</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%85%8D%E7%BD%AE%E8%AE%B0%E5%BD%95/">配置记录</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post-share"><div class="social-share" data-image="https://static.zahui.fan/public/MySQL.svg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="/pluginsSrc/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="/pluginsSrc/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/675d47a9/" title="使用keepalived完成LVS高可用"><img class="cover" src="https://static.zahui.fan/public/skeleton1.svg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">使用keepalived完成LVS高可用</div></div><div class="info-2"><div class="info-item-1"> 有了 keepalived 可以不用执行 ipvsadm 了， 并且可以实现自动剔除节点，还可以两台 Director 做高可用。  手动配置 LVS 请看 内核级负载均衡 LVS DR模式 部署记录 另见：使用Keepalived来实现Nginx高可用 规划：    机器 IP    VIP 10.0.0.8   director 10.0.0.40   realserver1 10.0.0.42   realserver2 10.0.0.43   网卡 interface eth0   单台 Director Serverkeepalived 配置： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950vrrp_sync_group GOP &#123;    group &#123;        VI_PRI_CONNECT        VI_PRI_AUTH    &#125;&#125;vrrp_instance...</div></div></div></a><a class="pagination-related" href="/posts/86a9c8f5/" title="优雅地给正在运行的MySQL添加从库"><img class="cover" src="https://static.zahui.fan/public/MySQL.svg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">优雅地给正在运行的MySQL添加从库</div></div><div class="info-2"><div class="info-item-1">前言之前写过一篇 MySQL主从同步配置 给 MySQL 配置从库，在主库在使用的情况下，需要将主库进行禁止写入操作，然后再导出导入，如果库比较大的话， 会对业务造成一定的影响。这篇文章主要介绍如何不停机进行添加从库。 主库操作开启 binlog123[mysqld]log_bin=mysql-binserver-id=1  这里注意 server-id 主从不能一样, 配置完成重启 mysql 创建用于同步的用户账号登陆数据库 1mysql -hlocalhost -uroot -ppassword  创建用户并授权 1CREATE USER &#x27;repl&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27;;  授权 12GRANT REPLICATION SLAVE ON *.* TO &#x27;repl&#x27;@&#x27;%&#x27;;flush privileges;  导出数据库 sql1mysqldump -uroot -ppassword -hlocalhost -P3306...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/b670229a/" title="编译安装MySQL5.7"><img class="cover" src="https://static.zahui.fan/public/MySQL.svg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-31</div><div class="info-item-2">编译安装MySQL5.7</div></div><div class="info-2"><div class="info-item-1">编译需要耗时，且对系统的依赖更为复杂，更容易出错， 如果没有必要，可以参考使用 二进制安装MySQL5.7 安装编译依赖Ubuntu和DebianCentOS和Fedora1sudo apt-get install -y build-essential cmake libaio-dev libncurses5-dev pkg-config1sudo yum -y install zlib-devel openssl-devel libaio-devel ncurses-devel cmake gcc-c++  编译设置安装路径12export BASE_DIR=&quot;/usr/local/mysql&quot;export DATA_DIR=&quot;/data/mysql&quot;  准备工作1234wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-boost-5.7.38.tar.gztar xf mysql-boost-5.7.38.tar.gz &amp;&amp; cd mysql-5.7.38[[...</div></div></div></a><a class="pagination-related" href="/posts/fa013442/" title="MySQL常用操作记录"><img class="cover" src="https://static.zahui.fan/public/MySQL.svg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-31</div><div class="info-item-2">MySQL常用操作记录</div></div><div class="info-2"><div class="info-item-1">记录一下日常工作中常用到的 MySQL 语句和一些配置等，方便日后查询 用户授权相关创建用户123-- CREATE USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27;;CREATE USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;  修改密码123-- ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27;;ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;  授权1Grant all privileges on *.* to &#x27;root&#x27;@&#x27;%&#x27; with...</div></div></div></a><a class="pagination-related" href="/posts/lmeiruso/" title="WSL2 - Ubuntu配置记录"><img class="cover" src="https://static.zahui.fan/public/wsl.svg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-12-09</div><div class="info-item-2">WSL2 - Ubuntu配置记录</div></div><div class="info-2"><div class="info-item-1">WSL 防火墙规则123Get-NetAdapterNew-NetFirewallRule -DisplayName &quot;WSL&quot; -Direction Inbound  -InterfaceAlias &quot;vEthernet (WSL)&quot;  -Action Allow  基础环境配置更换源使用中科大的源: https://mirrors.ustc.edu.cn/help/ubuntu.html 12345# 老版本Ubuntu# sudo sed -i &#x27;s@//.*.ubuntu.com@//mirrors.ustc.edu.cn@g&#x27; /etc/apt/sources.list# Ubuntu 24 及以上sudo sed -i &#x27;s@//.*.ubuntu.com@//mirrors.ustc.edu.cn@g&#x27; /etc/apt/sources.list.d/ubuntu.sources  安装常用的包12sudo apt update &amp;&amp; sudo apt upgrade...</div></div></div></a><a class="pagination-related" href="/posts/81886814/" title="WSLg配置图形支持和配置rime输入法"><img class="cover" src="https://static.zahui.fan/public/wsl.svg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-31</div><div class="info-item-2">WSLg配置图形支持和配置rime输入法</div></div><div class="info-2"><div class="info-item-1">WSLg 是微软的 wsl2 中自带的显示图形界面的功能，可以和 windows 完美融合在一块，不过由于 wsl 系统比较精简，会缺少一些图形包和输入法等。 设置中文显示安装依赖包12345678# 安装中文字体sudo apt install language-pack-zh-hans fonts-noto-cjk fonts-noto-cjk-extra# locales 配置 en_US.UTF-8 和 zh_CN.UTF-8 sudo sed -i &#x27;s/^# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/g&#x27; /etc/locale.gensudo sed -i &#x27;s/^# zh_CN.UTF-8 UTF-8/zh_CN.UTF-8 UTF-8/g&#x27; /etc/locale.gensudo locale-gen  设置显示语言为中文1234sudo tee /etc/default/locale...</div></div></div></a><a class="pagination-related" href="/posts/eee9a081/" title="WSL常用操作记录"><img class="cover" src="https://static.zahui.fan/public/wsl.svg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-31</div><div class="info-item-2">WSL常用操作记录</div></div><div class="info-2"><div class="info-item-1">防火墙规则1New-NetFirewallRule -DisplayName &quot;WSL&quot; -Direction Inbound  -InterfaceAlias &quot;vEthernet (WSL)&quot;  -Action Allow  常用操作导出1wsl --export centos7 centos7.tar  导入1wsl --import centos7 C:\centos7 centos7.tar  启动指定发行版1wsl -d centos7  指定用户启动1wsl -d ubuntu -u root  开机自启WSL1WSL2和Windows11win+r 输入 shell:startup 写一个 wsl_start.bat 内容如下 1wsl -d Ubuntu -u root /etc/init.d/ssh startsudo vim &#x2F;etc&#x2F;wsl.conf 12[boot]command = service docker start  修改默认用户为...</div></div></div></a><a class="pagination-related" href="/posts/sewhsk/" title="Windows 配置自动登录"><img class="cover" src="https://static.zahui.fan/public/Windows.svg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2024-10-31</div><div class="info-item-2">Windows 配置自动登录</div></div><div class="info-2"><div class="info-item-1">windows 中有部分应用程序需要登录当前账户才可以自动启动，或者嫌输密码麻烦，都可以设置自动登录，不用删除开机密码（删除开机密码也要鼠标点一下登录才可以登录） 修改注册表旧版本 windows 10 或者 windows 7 可以直接设置，但是新版本 windows 没有了这个选项，需要修改注册表配置 将下面文本保存成 reg 文件，双击导入。 1234Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\PasswordLess\Device]&quot;DevicePasswordLessBuildVersion&quot;=dword:00000000  netplwiz 配置win + R 输入 netplwiz 打开用户管理界面。  取消勾选 要使用本计算机，用户必须输入用户名和密码 选项， 在弹出的框中输入当前用户密码。  </div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://static.zahui.fan/public/dog.svg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">张理坤</div><div class="author-info-description">张理坤的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">351</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">218</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/iuxt"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/iuxt" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:x@zahui.fan" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/165330963" rel="external nofollow noreferrer" target="_blank" title="Bilibili"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="https://stackoverflow.com/users/15620461/" rel="external nofollow noreferrer" target="_blank" title="StackOverflow"><i class="fa-brands fa-stack-overflow"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fa-solid fa-square-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">此博客为我记录运维工作总结所用，供网友阅读参考，如有侵权，请通知我，我会核实后进行处理。</br>
<strong style="color: red;">欢迎加入技术交流群：</strong>
<div class="aside-qrcode" >
<img src="https://src.babudiu.com/card/wechat_ops_group.JPG" title="微信群" width="100%" height="auto">
</div>
</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84-MySQL-%E6%88%96-mariadb"><span class="toc-number">1.1.</span> <span class="toc-text">卸载系统中的 MySQL 或 mariadb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-number">1.2.</span> <span class="toc-text">下载二进制安装包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">1.3.</span> <span class="toc-text">创建用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%8C%85"><span class="toc-number">1.4.</span> <span class="toc-text">安装依赖包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84"><span class="toc-number">1.5.</span> <span class="toc-text">设置安装路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%8E%8B%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-number">1.6.</span> <span class="toc-text">解压安装包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.</span> <span class="toc-text">初始化数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E4%BF%9D%E5%AD%98%E7%9B%AE%E5%BD%95"><span class="toc-number">2.1.</span> <span class="toc-text">创建数据保存目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#initialize"><span class="toc-number">2.2.</span> <span class="toc-text">initialize</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%8E%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.</span> <span class="toc-text">配置文件与服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%9C%80%E5%B0%8F%E5%8C%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">创建最小化配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90-systemd-%E9%85%8D%E7%BD%AE"><span class="toc-number">3.2.</span> <span class="toc-text">生成 systemd 配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.3.</span> <span class="toc-text">启动服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E5%B7%A5%E4%BD%9C"><span class="toc-number">4.</span> <span class="toc-text">优化工作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">4.1.</span> <span class="toc-text">添加环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9-root-%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.</span> <span class="toc-text">修改 root 密码</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/stucr2/" title="使用 Python 自动截图 Grafana 仪表盘，实现可视化监控快照"><img src="https://static.zahui.fan/public/skeleton1.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 Python 自动截图 Grafana 仪表盘，实现可视化监控快照"/></a><div class="content"><a class="title" href="/posts/stucr2/" title="使用 Python 自动截图 Grafana 仪表盘，实现可视化监控快照">使用 Python 自动截图 Grafana 仪表盘，实现可视化监控快照</a><time datetime="2025-04-02T15:10:35.000Z" title="更新于 2025-04-02 23:10:35">2025-04-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ss2wk6/" title="使用Python识别验证码 ddddocr"><img src="https://static.zahui.fan/public/skeleton1.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用Python识别验证码 ddddocr"/></a><div class="content"><a class="title" href="/posts/ss2wk6/" title="使用Python识别验证码 ddddocr">使用Python识别验证码 ddddocr</a><time datetime="2025-04-01T06:36:31.000Z" title="更新于 2025-04-01 14:36:31">2025-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e48170f8/" title="改造windows terminal支持lrzsz"><img src="https://static.zahui.fan/images/202305102317430.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="改造windows terminal支持lrzsz"/></a><div class="content"><a class="title" href="/posts/e48170f8/" title="改造windows terminal支持lrzsz">改造windows terminal支持lrzsz</a><time datetime="2025-04-01T06:05:05.000Z" title="更新于 2025-04-01 14:05:05">2025-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/shqeci/" title="trzsz 使用记录"><img src="https://static.zahui.fan/images/202411221801168.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="trzsz 使用记录"/></a><div class="content"><a class="title" href="/posts/shqeci/" title="trzsz 使用记录">trzsz 使用记录</a><time datetime="2025-04-01T06:03:49.000Z" title="更新于 2025-04-01 14:03:49">2025-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/snrcqh/" title="在Windows中使用msys来运行linux命令"><img src="https://static.zahui.fan/public/skeleton1.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="在Windows中使用msys来运行linux命令"/></a><div class="content"><a class="title" href="/posts/snrcqh/" title="在Windows中使用msys来运行linux命令">在Windows中使用msys来运行linux命令</a><time datetime="2025-04-01T06:01:03.000Z" title="更新于 2025-04-01 14:01:03">2025-04-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="footer_custom_text"><a target="_blank" rel="noopener external nofollow noreferrer" href='https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral'>
  本网站由<img src='https://static.zahui.fan/public/upyun.svg' alt='又拍云' width='70' height='28' style="vertical-align:bottom">
  提供CDN加速/云存储服务
</a>
</br>
<a href="https://beian.miit.gov.cn/" rel="external nofollow noreferrer" target="_blank">沪ICP备2021015230号-1</a>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.umd.js"></script><script src="/pluginsSrc/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.babudiu.com/client.js',
      'data-repo': 'iuxt/iuxt.github.io',
      'data-repo-id': 'R_kgDOMszkdA',
      'data-category-id': 'DIC_kwDOMszkdM4CiMyw',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.babudiu.com')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜搜搜" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>